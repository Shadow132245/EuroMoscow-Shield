<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EuroMoscow | V110 SINGULARITY</title>
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='logo.png') }}">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Rajdhani:wght@500;700&family=JetBrains+Mono:wght@400;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/ayu-mirage.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>

    <style>
        :root {
            --bg: #020202;
            --primary: #ff0040; /* Singularity Red */
            --accent: #00ffcc;
            --border: rgba(255, 255, 255, 0.1);
            --font-head: 'Orbitron', sans-serif;
            --font-ui: 'Rajdhani', sans-serif;
        }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: #fff; font-family: var(--font-ui); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        
        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #333; border: 1px solid var(--primary); }

        /* NAV */
        nav { height: 70px; padding: 0 30px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border); background: rgba(10,10,10,0.95); z-index: 100; }
        .brand { font-family: var(--font-head); font-size: 20px; font-weight: 900; letter-spacing: 2px; }
        .brand span { color: var(--primary); text-shadow: 0 0 15px var(--primary); }
        .nav-btn { background: rgba(255,255,255,0.05); padding: 8px 15px; border-radius: 4px; cursor: pointer; border: 1px solid var(--border); font-weight: bold; color: #ccc; font-size: 11px; margin-left: 5px; }
        .nav-btn:hover { border-color: var(--primary); color: #fff; }

        /* LAYOUT */
        .layout { display: flex; flex: 1; overflow: hidden; }
        .sidebar { width: 360px; background: rgba(15,15,20,0.95); border-right: 1px solid var(--border); padding: 20px; display: flex; flex-direction: column; overflow-y: auto; }
        
        /* EDITOR */
        .editor-wrap { flex: 1; display: flex; flex-direction: column; background: #050505; }
        .CodeMirror { flex: 1; font-family: 'JetBrains Mono'; font-size: 14px; }

        /* CONTROLS */
        .section-title { font-family: var(--font-head); font-size: 10px; color: var(--primary); margin-bottom: 10px; letter-spacing: 1px; display: block; margin-top: 15px; }
        
        .opt-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .opt-item {
            display: flex; align-items: center; justify-content: space-between; padding: 12px;
            background: rgba(255,255,255,0.03); border: 1px solid transparent; border-radius: 4px; cursor: pointer; transition: 0.2s;
        }
        .opt-item:hover { border-color: var(--primary); background: rgba(255,0,64,0.05); }
        .opt-lbl { font-size: 11px; font-weight: 700; }
        .opt-check { width: 14px; height: 14px; border: 2px solid #444; display: flex; align-items: center; justify-content: center; }
        input:checked + .opt-check { background: var(--primary); border-color: var(--primary); }
        
        /* INPUTS */
        .cyber-input { width: 100%; background: #000; border: 1px solid var(--border); color: var(--accent); padding: 10px; font-family: 'JetBrains Mono'; font-size: 11px; margin-bottom: 10px; display: none; }
        .cyber-input.active { display: block; animation: slideDown 0.3s ease; }
        @keyframes slideDown { from{opacity:0; transform:translateY(-10px);} to{opacity:1; transform:translateY(0);} }

        /* BUTTON */
        .btn-singularity {
            width: 100%; padding: 15px; background: var(--primary); color: #000; border: none; font-family: var(--font-head);
            font-weight: 900; margin-top: 20px; cursor: pointer; clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
            transition: 0.3s;
        }
        .btn-singularity:hover { box-shadow: 0 0 30px var(--primary); letter-spacing: 2px; }

        /* RESPONSIVE */
        @media (max-width: 900px) {
            .layout { flex-direction: column; }
            .sidebar { width: 100%; height: auto; order: 2; border-top: 1px solid var(--border); }
            .editor-wrap { height: 50vh; order: 1; }
        }
    </style>
</head>
<body>

    <nav>
        <div class="brand">V110 <span>SINGULARITY</span></div>
        <div>
            <button class="nav-btn" onclick="copyResult()">COPY</button>
            <button class="nav-btn" onclick="location.reload()">RESET</button>
        </div>
    </nav>

    <div class="layout">
        <div class="sidebar">
            <span class="section-title">CORE LANGUAGE</span>
            <select id="lang" style="width:100%; padding:10px; background:#000; color:#fff; border:1px solid var(--border); margin-bottom:10px;">
                <option value="python">PYTHON (Singularity Engine)</option>
                <option value="javascript">JAVASCRIPT</option>
                <option value="lua">LUA</option>
            </select>

            <span class="section-title">CYBER WEAPONRY (FEATURES)</span>
            <div class="opt-grid">
                <label class="opt-item" onclick="toggleInput('webhook')">
                    <span class="opt-lbl">DISCORD SPY üì°</span>
                    <input type="checkbox" id="opt-webhook" hidden>
                    <div class="opt-check"></div>
                </label>
                <label class="opt-item">
                    <span class="opt-lbl">FERNET AES üîí</span>
                    <input type="checkbox" id="opt-fernet" hidden>
                    <div class="opt-check"></div>
                </label>
                <label class="opt-item">
                    <span class="opt-lbl">ANTI-DISASSEMBLY üõ°Ô∏è</span>
                    <input type="checkbox" id="opt-antidis" hidden>
                    <div class="opt-check"></div>
                </label>
                <label class="opt-item">
                    <span class="opt-lbl">FAKE ERROR üé≠</span>
                    <input type="checkbox" id="opt-fakeerror" hidden>
                    <div class="opt-check"></div>
                </label>
                <label class="opt-item">
                    <span class="opt-lbl">NTP TIME LOCK üåç</span>
                    <input type="checkbox" id="opt-ntp" hidden>
                    <div class="opt-check"></div>
                </label>
                <label class="opt-item">
                    <span class="opt-lbl">AST RENAMING üìù</span>
                    <input type="checkbox" id="opt-rename" checked hidden>
                    <div class="opt-check"></div>
                </label>
            </div>

            <input id="inp-webhook" class="cyber-input" placeholder="Paste Discord Webhook URL Here...">

            <button class="btn-singularity" id="btn" onclick="process()">INITIATE SINGULARITY</button>
        </div>

        <div class="editor-wrap">
            <textarea id="editor"></textarea>
        </div>
    </div>

    <script>
        var editor = CodeMirror.fromTextArea(document.getElementById("editor"), { mode: "python", theme: "ayu-mirage", lineNumbers: true });

        function toggleInput(id) {
            const chk = document.getElementById('opt-'+id);
            const inp = document.getElementById('inp-'+id);
            setTimeout(() => {
                if(chk.checked && inp) inp.classList.add('active');
                else if(inp) inp.classList.remove('active');
            }, 100);
        }

        async function process() {
            const code = editor.getValue();
            if(!code.trim()) return alert("BUFFER EMPTY");
            
            const btn = document.getElementById('btn');
            btn.innerText = "ENCRYPTING...";
            
            // Collect Options
            let opts = [];
            document.querySelectorAll('input[type="checkbox"]:checked').forEach(c => opts.push(c.id.replace('opt-','')));
            
            // Collect Params
            let params = {};
            const webhook = document.getElementById('inp-webhook').value;
            if(webhook) params.webhook_url = webhook;

            try {
                const res = await fetch('/process', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        code: code,
                        action: 'encrypt',
                        lang: document.getElementById('lang').value,
                        options: opts,
                        params: params
                    })
                });
                const data = await res.json();
                editor.setValue(data.result);
                btn.innerText = "DEPLOYED SUCCESSFULLY";
            } catch(e) {
                alert("SYSTEM FAILURE: " + e);
                btn.innerText = "INITIATE SINGULARITY";
            }
        }

        function copyResult() {
            navigator.clipboard.writeText(editor.getValue());
            alert("PAYLOAD COPIED");
        }
    </script>
</body>
</html>
