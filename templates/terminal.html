<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EuroMoscow Shield | Terminal</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        
        body { margin: 0; background: #000; color: #0f0; font-family: 'VT323', monospace; font-size: 20px; overflow: hidden; height: 100vh; padding: 20px; text-shadow: 0 0 5px #0f0; }
        
        /* CRT Effect */
        body::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        #terminal { max-width: 1000px; margin: 0 auto; height: 100%; display: flex; flex-direction: column; }
        #output { flex: 1; overflow-y: auto; white-space: pre-wrap; margin-bottom: 20px; }
        
        .input-line { display: flex; align-items: center; border-top: 1px solid #333; padding-top: 10px; }
        .prompt { color: #f0f; margin-right: 10px; font-weight: bold; }
        input { background: transparent; border: none; color: #fff; font-family: 'VT323', monospace; font-size: 20px; flex: 1; outline: none; }
        
        .success { color: #0ff; }
        .error { color: #f00; }
        .info { color: #ff0; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #0f0; }
        
        .back-btn { position: absolute; top: 20px; right: 20px; color: #666; text-decoration: none; border: 1px solid #333; padding: 5px 10px; z-index: 10; font-family: sans-serif; font-size: 12px; }
        .back-btn:hover { color: #fff; border-color: #fff; }
    </style>
</head>
<body>
    <a href="/" class="back-btn">EXIT TERMINAL</a>

    <div id="terminal">
        <div id="output">
   _____                 __  __                                  
  | ____|_   _ _ __ ___ |  \/  | ___  ___  ___ _____      __     
  |  _| | | | | '__/ _ \| |\/| |/ _ \/ __|/ __/ _ \ \ /\ / /     
  | |___| |_| | | | (_) | |  | | (_) \__ \ (_| (_) \ V  V /      
  |_____|\__,_|_|  \___/|_|  |_|\___/|___/\___\___/ \_/\_/       
                                                                 
  SHIELD v10.0 [Terminal Mode]
  Type 'help' for commands.
        </div>
        <div class="input-line">
            <span class="prompt">root@euromoscow:~#</span>
            <input type="text" id="cmd" autofocus autocomplete="off" spellcheck="false">
        </div>
    </div>

    <script>
        const output = document.getElementById('output');
        const input = document.getElementById('cmd');

        function print(text, className='') {
            const line = document.createElement('div');
            line.className = className;
            line.textContent = text;
            output.appendChild(line);
            output.scrollTop = output.scrollHeight;
        }

        async function processCommand(cmd) {
            const args = cmd.trim().split(' ');
            const command = args[0].toLowerCase();
            const payload = args.slice(1).join(' ');

            if (command === 'clear' || command === 'cls') {
                output.innerHTML = '';
            } 
            else if (command === 'help') {
                print("Available Commands:", "info");
                print("  encrypt [code]   - Obfuscate Python code (All layers)");
                print("  decrypt [code]   - Auto-decrypt Python/JS");
                print("  jsenc [code]     - Encrypt JavaScript");
                print("  clear            - Clear screen");
                print("  exit             - Return to GUI");
            } 
            else if (command === 'exit') {
                window.location.href = '/';
            }
            else if (command === 'encrypt' || command === 'jsenc' || command === 'decrypt') {
                if(!payload) { print("Error: No code provided.", "error"); return; }
                
                print(`Processing [${command}]...`, "info");
                
                let action = command === 'decrypt' ? 'decrypt' : 'encrypt';
                let lang = command === 'jsenc' ? 'javascript' : 'python';
                let options = ['rename', 'marshal', 'xor', 'zlib', 'base64']; // Full power
                
                if(lang === 'javascript') options = ['hex', 'base64', 'url'];

                try {
                    const res = await fetch('/process', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ code: payload, action, lang, options })
                    });
                    const data = await res.json();
                    print("---------------- RESULT ----------------", "success");
                    print(data.result);
                    print("----------------------------------------", "success");
                } catch(e) {
                    print("Error: Server connection failed.", "error");
                }
            } 
            else if (cmd.trim() !== '') {
                print(`Command not found: ${command}`, "error");
            }
        }

        input.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const val = this.value;
                print(`root@euromoscow:~# ${val}`);
                processCommand(val);
                this.value = '';
            }
        });
        
        // Keep focus
        document.body.addEventListener('click', () => input.focus());
    </script>
</body>
</html>
